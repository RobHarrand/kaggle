{
    "collab_server" : "",
    "contents" : "tb_1 = read.csv('tubercolusis_from 2007_WHO.csv')\ntb_2 = read.csv('tuberculosis_data_WHO.csv')\n\nlibrary('stringr')\n\n#Let's take a look at the first dataset,\n\nstr(tb_1)\n\nstr(tb_1)\n\nlength(table(tb_1$Country))\nlength(table(tb_2$Country))\n\ntb = merge(tb_1, tb_2)\n\ntb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV = as.numeric(tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV)\n\nboxplot(tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV ~ tb_1$Country)\n\ntb_1$Year = as.Date(tb_1$Year, format = \"%Y\")\n\n?as.Date\n\nplot(tb_1$Year, cumsum(tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV))\n\n\ntable(tb_2$World.Bank.income.group)\n\nstr(tb_2$World.Bank.income.group)\n\ntb_2$World.Bank.income.group = factor(tb_2$World.Bank.income.group, levels = c(\"Low-income\",\n                                                                               \"Low-middle-income\",\n                                                                               \"Upper-middle-income\",\n                                                                               \"Upper-income\"))\n\nboxplot(tb_2$High[tb_2$Indicator == \"Number of prevalent tuberculosis cases\"] ~\n          tb_2$World.Bank.income.group[tb_2$Indicator == \"Number of prevalent tuberculosis cases\"],\n        outline = F)\n\nlibrary(ggplot2)\n\ntable(is.na(tb_2$Numeric))\n\n\n\nggplot(tb_2[tb_2$Indicator == \"Number of prevalent tuberculosis cases\" & tb_2$WHO.region == 'Africa',], \n       aes(factor(tb_2$Year[tb_2$Indicator == \"Number of prevalent tuberculosis cases\" & tb_2$WHO.region == 'Africa']), \n           tb_2$Numeric[tb_2$Indicator == \"Number of prevalent tuberculosis cases\" & tb_2$WHO.region == 'Africa'])) +\n  geom_violin()\n\nrange(tb_2$Numeric[tb_2$Indicator == \"Number of prevalent tuberculosis cases\"])\n\nggplot(tb_2[tb_2$Indicator == \"Number of prevalent tuberculosis cases\" & tb_2$WHO.region == 'Africa',], \n       aes(factor(tb_2$Year[tb_2$Indicator == \"Number of prevalent tuberculosis cases\" & tb_2$WHO.region == 'Africa']), \n           tb_2$Numeric[tb_2$Indicator == \"Number of prevalent tuberculosis cases\" & tb_2$WHO.region == 'Africa'])) +\n  geom_boxplot()\n\n\nlength(tb_2$Year[tb_2$Indicator == \"Number of prevalent tuberculosis cases\"])\n\nlength(tb_2$Year[tb_2$Indicator == \"Number of prevalent tuberculosis cases\"])\n\n\nplot(tb_2$Year, tb_2$Numeric, col = tb_2$WHO.region)\n\ntable(tb_2$WHO.region)\n\n\n\n\n\n\n\n---\n  \n#Load libraries,\nrequire(ggplot2)\nrequire(animation)\nlibrary('maptools')\n\n#Load the map data,\ns = map_data(\"world\")\n\n# s = s[s$region == 'USA' | s$region == 'Mexico' | s$region == 'Panama' | s$region == 'Nicaragua' | s$region == 'Haiti' | s$region == 'Guatemala' \n#       | s$region == 'El Salvador' | s$region == 'Ecuador' | s$region == 'Dominican Republic' | s$region == 'Colombia' \n#       | s$region == 'Argentina' | s$region == 'Brazil',]\n?str_trim\n\n\ntb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV = as.character(tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV)\ntb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV = gsub(\" \", \"\", tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV)\ntb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV = as.numeric(tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV)\n\n#tb_1$Year = as.Date(as.character(tb_1$Year), '%Y')\n\n#Exclude rows with missing data,\n#exc.Numbers = (is.na(zika$report_date) | (is.na(zika$value)))\n#zika = zika[!exc.Numbers, ]\n\n#zika$value[is.na(zika$value)] = 0\n\n#zika$value = as.character(zika$value)\n\n#table(is.na(zika$value))\n\ns$colour = 0\n\n\n#firstdate = zika$report_date[order(zika$report_date)][1]\n#lastdate = zika$report_date[order(zika$report_date)][length(zika$report_date)]\n#duration = lastdate - firstdate\n\nt = as.data.frame(table(tb_1$Country))\n\nex = (t$Var1 == 'South Sudan' | t$Var1 == 'India')\nt = t[!ex,]\n\nt$y_2007 = 0\nt$y_2008 = 0\nt$y_2009 = 0\nt$y_2010 = 0\nt$y_2011 = 0\nt$y_2012 = 0\nt$y_2013 = 0\nt$y_2014 = 0\n\ni=1\n\nwhile (i<=length(t$Var1)) {\n\nt[i,3] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2007]\nt[i,4] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2008]\nt[i,5] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2009]\nt[i,6] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2010]\nt[i,7] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2011]\nt[i,8] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2012]\nt[i,9] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2013]\nt[i,10] = tb_1$Number.of.deaths.due.to.tuberculosis..excluding.HIV[tb_1$Country == t[i,1] & tb_1$Year == 2014]\n\ni=i+1\n\n}\n\n\n#Loop through the rows and save the gif...\n\n#table(s$colour)\n\ni=1\n\nwhile (i<=length(t$Var1)) {\n  \n  t[i,10] = t[i,10] - t[i,3]\n  t[i,9] = t[i,9] - t[i,3]\n  t[i,8] = t[i,8] - t[i,3]\n  t[i,7] = t[i,7] - t[i,3]\n  t[i,6] = t[i,6] - t[i,3]\n  t[i,5] = t[i,5] - t[i,3]\n  t[i,4] = t[i,4] - t[i,3]\n  t[i,3] = t[i,3] - t[i,3]\n  \n  i=i+1\n  \n}\n\ni=1\n\nsaveGIF(while (i<=8) {\n\n  y=1\n  \n  while (y<=length(t$Var1)) {\n    \n    s$colour[grep(t[y,1], s$region)] = (t[y,i+2])\n    y=y+1\n  }\n    \n  print(m <- ggplot(s, aes(x=long, y=lat, group=group, fill=colour)) + #Set ggplot2\n          \n          geom_polygon(alpha=1) + #Set transparency\n          \n          geom_path(data = s, aes(x=long, y=lat, group=group), colour=\"black\") + #Plot the Earth\n          \n          scale_fill_gradient(low = \"green\", high = \"red\", guide = \"colourbar\", limits=c(-34000,40000)) + #Set the colours,\n                                \n          theme(plot.title = element_text(size = rel(2))) + #Change the text size,\n          \n          ggtitle(paste(\"The Spread of the TB: \", 2006+i)))\n  \n  #dev.off()\n  \n  #totals[i+1,] = c(runsum_brazil, runsum_argentina, runsum_colombia, runsum_dominican_republic, runsum_ecuador, runsum_el_salvador,\n  #                    runsum_guatemala, runsum_haiti, runsum_nicaragua, runsum_panama, runsum_usa, runsum_mexico)\n  \n  #Wait a while between plots,\n  ani.pause()\n  \n  i=i+1\n  \n}, movie.name = \"tb_ani.gif\", interval = 1, convert = \"convert\", ani.width = 1000, \nani.height = 700)\n\n\n\n\nrange(t$y_2007)\nrange(t$y_2008)\nrange(t$y_2009)\nrange(t$y_2010)\nrange(t$y_2011)\nrange(t$y_2012)\nrange(t$y_2013)\nrange(t$y_2014)\n\nlog(-160000)\n\ntb_1$Number.of.prevalent.tuberculosis.cases = as.character(tb_1$Number.of.prevalent.tuberculosis.cases)\ntb_1$Number.of.prevalent.tuberculosis.cases = gsub(\" \", \"\", tb_1$Number.of.prevalent.tuberculosis.cases)\ntb_1$Number.of.prevalent.tuberculosis.cases = as.numeric(tb_1$Number.of.prevalent.tuberculosis.cases)\n\nrange(tb_1$Number.of.prevalent.tuberculosis.cases)\n\n\n",
    "created" : 1470574757268.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1947471159",
    "id" : "83EE73E0",
    "lastKnownWriteTime" : 1470604695,
    "last_content_update" : 1470604695346,
    "path" : "~/Desktop/Kaggle/TB/TB.R",
    "project_path" : "TB.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}