{
    "contents" : "#Load libraries,\nrequire(ggplot2)\nrequire(animation)\nlibrary('maptools')\n\nzika = read.csv(\"cdc_zika.csv\", stringsAsFactors = F)\n\n#Load the map data,\ns = map_data(\"world\")\n\n# s = s[s$region == 'USA' | s$region == 'Mexico' | s$region == 'Panama' | s$region == 'Nicaragua' | s$region == 'Haiti' | s$region == 'Guatemala' \n#       | s$region == 'El Salvador' | s$region == 'Ecuador' | s$region == 'Dominican Republic' | s$region == 'Colombia' \n#       | s$region == 'Argentina' | s$region == 'Brazil',]\n\nzika$value = as.numeric(zika$value)\nzika$report_date = as.Date(zika$report_date, '%Y-%m-%d')\n\n#Exclude rows with missing data,\nexc.Numbers = (is.na(zika$report_date) | (is.na(zika$value)))\nzika = zika[!exc.Numbers, ]\n\n#zika$value[is.na(zika$value)] = 0\n\n#zika$value = as.character(zika$value)\n\n#table(is.na(zika$value))\n\ns$colour = 1\n\n\nfirstdate = zika$report_date[order(zika$report_date)][1]\nlastdate = zika$report_date[order(zika$report_date)][length(zika$report_date)]\nduration = lastdate - firstdate\n\ni=0\nrunsum_usa = 0\nrunsum_mexico = 0\nrunsum_panama = 0\nrunsum_nicaragua = 0\nrunsum_haiti = 0\nrunsum_guatemala = 0\nrunsum_el_salvador = 0\nrunsum_ecuador = 0\nrunsum_dominican_republic = 0\nrunsum_colombia = 0\nrunsum_argentina = 0\nrunsum_brazil = 0\n\ntotals = data.frame(runsum_brazil, runsum_argentina, runsum_colombia, runsum_dominican_republic, runsum_ecuador, runsum_el_salvador,\n                    runsum_guatemala, runsum_haiti, runsum_nicaragua, runsum_panama, runsum_usa, runsum_mexico)\n\nusa =  zika[grep(\"United_States\", zika$location),]\nmexico = zika[grep(\"Mexico\", zika$location),]\npanama = zika[grep(\"Panama\", zika$location),]\nnicaragua = zika[grep(\"Nicaragua\", zika$location),]\nhaiti = zika[grep(\"Haiti\", zika$location),]\nguatemala = zika[grep(\"Guatemala\", zika$location),]\nel_salvador = zika[grep(\"El_Salvador\", zika$location),]\necuador = zika[grep(\"Ecuador\", zika$location),]\ndominican_republic = zika[grep(\"Dominican_Republic\", zika$location),]\ncolombia = zika[grep(\"Colombia\", zika$location),]\nargentina = zika[grep(\"Argentina\", zika$location),]\nbrazil = zika[grep(\"Brazil\", zika$location),]\n\n\n#Set animation time,\nani.options(interval = 0.1)\n\n\n#Loop through the rows and save the gif...\n\nsaveGIF(while (i<duration) {\n\n    temp_sum_usa = sum(usa$value[usa$report_date == firstdate+i])\n    runsum_usa = runsum_usa + temp_sum_usa\n    s$colour[grep(\"USA\", s$region)] = log(runsum_usa)\n    \n    temp_sum_mexico = sum(mexico$value[mexico$report_date == firstdate+i])\n    runsum_mexico = runsum_mexico + temp_sum_mexico\n    s$colour[grep(\"Mexico\", s$region)] = log(runsum_mexico)\n\n    temp_sum_panama = sum(panama$value[panama$report_date == firstdate+i])\n    runsum_panama = runsum_panama + temp_sum_panama\n    s$colour[grep(\"Panama\", s$region)] = log(runsum_panama)\n    \n    temp_sum_nicaragua = sum(nicaragua$value[nicaragua$report_date == firstdate+i])\n    runsum_nicaragua = runsum_nicaragua + temp_sum_nicaragua\n    s$colour[grep(\"Nicaragua\", s$region)] = log(runsum_nicaragua)\n    \n    temp_sum_haiti = sum(haiti$value[haiti$report_date == firstdate+i])\n    runsum_haiti = runsum_haiti + temp_sum_haiti\n    s$colour[grep(\"Haiti\", s$region)] = log(runsum_haiti)\n    \n    temp_sum_guatemala = sum(guatemala$value[guatemala$report_date == firstdate+i])\n    runsum_guatemala = runsum_guatemala + temp_sum_guatemala\n    s$colour[grep(\"Guatemala\", s$region)] = log(runsum_guatemala)\n    \n    temp_sum_el_salvador = sum(el_salvador$value[el_salvador$report_date == firstdate+i])\n    runsum_el_salvador = runsum_el_salvador + temp_sum_el_salvador\n    s$colour[grep(\"El_Salvador\", s$region)] = log(runsum_el_salvador)\n    \n    temp_sum_ecuador = sum(ecuador$value[ecuador$report_date == firstdate+i])\n    runsum_ecuador = runsum_ecuador + temp_sum_ecuador\n    s$colour[grep(\"Ecuador\", s$region)] = log(runsum_ecuador)\n    \n    temp_sum_dominican_republic = sum(dominican_republic$value[dominican_republic$report_date == firstdate+i])\n    runsum_dominican_republic = runsum_dominican_republic + temp_sum_dominican_republic\n    s$colour[grep(\"Dominican_Republic\", s$region)] = log(runsum_dominican_republic)\n    \n    temp_sum_colombia = sum(colombia$value[colombia$report_date == firstdate+i])\n    runsum_colombia = runsum_colombia + temp_sum_colombia\n    s$colour[grep(\"Colombia\", s$region)] = log(runsum_colombia)\n    \n    temp_sum_argentina = sum(argentina$value[argentina$report_date == firstdate+i])\n    runsum_argentina = runsum_argentina + temp_sum_argentina\n    s$colour[grep(\"Argentina\", s$region)] = log(runsum_argentina)\n    \n    temp_sum_brazil = sum(brazil$value[brazil$report_date == firstdate+i])\n    runsum_brazil = runsum_brazil + temp_sum_brazil\n    s$colour[grep(\"Brazil\", s$region)] = log(runsum_brazil)\n    \n    #jpeg(paste('rplot',i,'.jpg', sep=\"\"))\n    \n    print(m <- ggplot(s, aes(x=long, y=lat, group=group, fill=colour)) + #Set ggplot2\n              \n              geom_polygon(alpha=1) + #Set transparency\n              \n              geom_path(data = s, aes(x=long, y=lat, group=group), colour=\"black\") + #Plot the Earth\n              \n              scale_fill_gradient(low = \"black\", high = \"red\", guide = \"colourbar\", limits=c(0,14.52374)) + #Set the colours,\n              \n              theme(plot.title = element_text(size = rel(2))) + #Change the text size,\n              \n              ggtitle(paste(\"The Spread of the Zika Virus: \", lastdate+i)))\n    \n    #dev.off()\n\n    totals[i+1,] = c(runsum_brazil, runsum_argentina, runsum_colombia, runsum_dominican_republic, runsum_ecuador, runsum_el_salvador,\n                        runsum_guatemala, runsum_haiti, runsum_nicaragua, runsum_panama, runsum_usa, runsum_mexico)\n    \n    #Wait a while between plots,\n    ani.pause()\n    \n    i=i+1\n    \n}, movie.name = \"Zika_ani.gif\", interval = 0.15, convert = \"convert\", ani.width = 800, \nani.height = 800)\n\n\n\n\n\ny=1\n\ntotals$Date = firstdate\n\nwhile(y<=length(totals$Date)) {\n\n    totals$Date[y] = firstdate+y\n    y=y+1\n}\n\n\nplot(totals$Date, log(totals$runsum_brazil), type = \"l\", lwd = 2, main = \"Spread of Zika virus\", xlab = \"Date\", ylab = \"Counts\")\nlines(totals$Date, log(totals$runsum_argentina), type = \"l\", col = \"red\", lwd = 2)\nlines(totals$Date, log(totals$runsum_colombia), type = \"l\", col = \"blue\", lwd = 2)\nlines(totals$Date, log(totals$runsum_dominican_republic), type = \"l\", col = \"orange\", lwd = 2)\nlines(totals$Date, log(totals$runsum_ecuador), type = \"l\", col = \"green\", lwd = 2)\nlines(totals$Date, log(totals$runsum_el_salvador), type = \"l\", col = \"purple\", lwd = 2)\nlines(totals$Date, log(totals$runsum_guatemala), type = \"l\", col = \"pink\", lwd = 2)\nlines(totals$Date, log(totals$runsum_haiti), type = \"l\", col = \"light blue\", lwd = 2)\nlines(totals$Date, log(totals$runsum_nicaragua), type = \"l\", col = \"light green\", lwd = 2)\nlines(totals$Date, log(totals$runsum_panama), type = \"l\", col = \"grey\", lwd = 2)\nlines(totals$Date, log(totals$runsum_usa), type = \"l\", col = \"aquamarine1\", lwd = 2)\nlines(totals$Date, log(totals$runsum_mexico), type = \"l\", col = \"darkgoldenrod2\", lwd = 2)\n#legend(,13, c(\"23323\"))\n\n\n\n\n\n",
    "created" : 1469176885893.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2553819162",
    "id" : "8A27D791",
    "lastKnownWriteTime" : 1469202701,
    "path" : "C:/Users/rob.harrand/Desktop/WORK/Kaggle/Zika/zika/zika.R",
    "project_path" : "zika.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}